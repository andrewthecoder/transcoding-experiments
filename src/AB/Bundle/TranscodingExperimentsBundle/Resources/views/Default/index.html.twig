{% extends "OryzoneBoilerplateBundle::html5.html.twig" %}

{% block head_title %}Transcoding Experiments{% endblock %}

{% block body_container_header %}
<style type="text/css">
	html,body,div#container,div#container>div {
		height: 100%;
		position: relative;
	}
</style>
{% endblock %}

{% block body_container_main %}
	<div id="playerDiv" style="text-align: center;"><img src="{{ asset('bundles/abtranscodingexperiments/images/ajax-loader.gif') }}" style="margin-top: 400px;" /></div>
{% endblock %}

{% block body_container_footer %}
{% endblock %}

{% block body_js %}
	{% javascripts '@ABTranscodingExperimentsBundle/Resources/public/js/jquery-1.11.0.min.js'
	               '@ABTranscodingExperimentsBundle/Resources/public/js/measureBandwidth.js' %}
        <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}
	<script type="text/javascript" src="{{ asset('bundles/abtranscodingexperiments/js/jwplayer.js') }}"></script>
	
	<script type="text/javascript">
		$(document).ready( function(){
			measureBandwidth(3000, function loadVideo(endKBps) {
                filePathEncoded = encodeURIComponent('bbb30.mp4');
				jwplayer.key="Ut7x12R7l6aymBL5bQXj2vlutEPMbLBoUvdzcQ==";
				jwplayer("playerDiv").setup({
					playlist: [{
						sources: [
							{ file: '/app_dev.php/transcode/'+endKBps+'/'+filePathEncoded+'/stream.webm' }
							//,{ file: '/app_dev.php/transcode/'+endKBps+'/'+filePathEncoded+'/stream.webm' }
						]
					}],
					autostart: 'true',
					width: "100%",
					height: "90%",
					skin: "{{ asset('bundles/abtranscodingexperiments/xml/six.xml') }}",
					flashplayer: "{{ asset('bundles/abtranscodingexperiments/swf/jwplayer.swf') }}",
					html5player: "{{ asset('bundles/abtranscodingexperiments/js/jwplayer.html5.js') }}"
				});					
			});
		});
	</script>
{% endblock %}